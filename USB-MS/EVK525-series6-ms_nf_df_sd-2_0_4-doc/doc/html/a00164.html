<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>ATMEL: nf_mngt.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.3 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="classes.html"><span>Data&nbsp;Structures</span></a></li>
    <li class="current"><a href="files.html"><span>Files</span></a></li>
  </ul>
</div>
<h1>nf_mngt.h</h1><a href="a00063.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*This file is prepared for Doxygen automatic documentation generation.*/</span>
<a name="l00015"></a>00015 
<a name="l00016"></a>00016 <span class="comment">/* Copyright (c) 2009 Atmel Corporation. All rights reserved.</span>
<a name="l00017"></a>00017 <span class="comment"> *</span>
<a name="l00018"></a>00018 <span class="comment"> * Redistribution and use in source and binary forms, with or without</span>
<a name="l00019"></a>00019 <span class="comment"> * modification, are permitted provided that the following conditions are met:</span>
<a name="l00020"></a>00020 <span class="comment"> *</span>
<a name="l00021"></a>00021 <span class="comment"> * 1. Redistributions of source code must retain the above copyright notice,</span>
<a name="l00022"></a>00022 <span class="comment"> * this list of conditions and the following disclaimer.</span>
<a name="l00023"></a>00023 <span class="comment"> *</span>
<a name="l00024"></a>00024 <span class="comment"> * 2. Redistributions in binary form must reproduce the above copyright notice,</span>
<a name="l00025"></a>00025 <span class="comment"> * this list of conditions and the following disclaimer in the documentation</span>
<a name="l00026"></a>00026 <span class="comment"> * and/or other materials provided with the distribution.</span>
<a name="l00027"></a>00027 <span class="comment"> *</span>
<a name="l00028"></a>00028 <span class="comment"> * 3. The name of Atmel may not be used to endorse or promote products derived</span>
<a name="l00029"></a>00029 <span class="comment"> * from this software without specific prior written permission.</span>
<a name="l00030"></a>00030 <span class="comment"> *</span>
<a name="l00031"></a>00031 <span class="comment"> * 4. This software may only be redistributed and used in connection with an Atmel</span>
<a name="l00032"></a>00032 <span class="comment"> * AVR product.</span>
<a name="l00033"></a>00033 <span class="comment"> *</span>
<a name="l00034"></a>00034 <span class="comment"> * THIS SOFTWARE IS PROVIDED BY ATMEL "AS IS" AND ANY EXPRESS OR IMPLIED</span>
<a name="l00035"></a>00035 <span class="comment"> * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF</span>
<a name="l00036"></a>00036 <span class="comment"> * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT ARE EXPRESSLY AND</span>
<a name="l00037"></a>00037 <span class="comment"> * SPECIFICALLY DISCLAIMED. IN NO EVENT SHALL ATMEL BE LIABLE FOR ANY DIRECT,</span>
<a name="l00038"></a>00038 <span class="comment"> * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES</span>
<a name="l00039"></a>00039 <span class="comment"> * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;</span>
<a name="l00040"></a>00040 <span class="comment"> * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND</span>
<a name="l00041"></a>00041 <span class="comment"> * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT</span>
<a name="l00042"></a>00042 <span class="comment"> * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF</span>
<a name="l00043"></a>00043 <span class="comment"> * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00044"></a>00044 <span class="comment"> */</span>
<a name="l00045"></a>00045 
<a name="l00046"></a>00046 <span class="preprocessor">#ifndef _NF_MNGT_H_</span>
<a name="l00047"></a>00047 <span class="preprocessor"></span><span class="preprocessor">#define _NF_MNGT_H_</span>
<a name="l00048"></a>00048 <span class="preprocessor"></span>
<a name="l00049"></a>00049 <span class="comment">//_____ I N C L U D E S ____________________________________________________</span>
<a name="l00050"></a>00050 
<a name="l00051"></a>00051 <span class="preprocessor">#include "<a class="code" href="a00039.html">config.h</a>"</span>
<a name="l00052"></a>00052 <span class="preprocessor">#include "<a class="code" href="a00035.html">conf_nf.h</a>"</span>
<a name="l00053"></a>00053 <span class="preprocessor">#include "<a class="code" href="a00057.html">nf.h</a>"</span>
<a name="l00054"></a>00054 <span class="preprocessor">#include "<a class="code" href="a00042.html">modules/control_access/ctrl_status.h</a>"</span>
<a name="l00055"></a>00055 <span class="preprocessor">#include "<a class="code" href="a00061.html">nf_drv.h</a>"</span>
<a name="l00056"></a>00056 
<a name="l00057"></a>00057 <span class="comment">//_____ M A C R O S ________________________________________________________</span>
<a name="l00058"></a>00058 
<a name="l00059"></a>00059 <span class="comment">//_____ D E C L A R A T I O N ______________________________________________</span>
<a name="l00060"></a>00060 
<a name="l00061"></a><a class="code" href="a00063.html#f207755082cb7bb8864b85d95f7fb427">00061</a> <span class="preprocessor">#define NF_BLK_RCV_NO_RECOVERY        0xA5</span>
<a name="l00062"></a><a class="code" href="a00063.html#3cc1d460022d2bb25b955d00742b0eb7">00062</a> <span class="preprocessor"></span><span class="preprocessor">#define NF_BLK_RCV_PENDING_RECOVERY   0x5A</span>
<a name="l00063"></a>00063 <span class="preprocessor"></span>
<a name="l00064"></a><a class="code" href="a00063.html#714ce5649e72db34c2ef646c284321ae">00064</a> <span class="preprocessor">#define NF_LOW_N_FREE_THRESHOLD      5     // Min number of free blocks, otherwize the memory need to be reformatted</span>
<a name="l00065"></a>00065 <span class="preprocessor"></span>
<a name="l00066"></a>00066 <span class="preprocessor">#if (NF_N_DEVICES==1)</span>
<a name="l00067"></a>00067 <span class="preprocessor"></span><span class="preprocessor">#  define NF_SHIFT_N_DEVICES           0 // (1&lt;&lt;n) Number of devices</span>
<a name="l00068"></a>00068 <span class="preprocessor"></span>
<a name="l00069"></a>00069 <span class="preprocessor">#elif (NF_N_DEVICES==2)</span>
<a name="l00070"></a>00070 <span class="preprocessor"></span><span class="preprocessor">#  define NF_SHIFT_N_DEVICES           1 // (1&lt;&lt;n) Number of devices</span>
<a name="l00071"></a>00071 <span class="preprocessor"></span>
<a name="l00072"></a>00072 <span class="preprocessor">#elif (NF_N_DEVICES==4)</span>
<a name="l00073"></a>00073 <span class="preprocessor"></span><span class="preprocessor">#  define NF_SHIFT_N_DEVICES           2 // (1&lt;&lt;n) Number of devices</span>
<a name="l00074"></a>00074 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00075"></a>00075 <span class="preprocessor"></span>
<a name="l00076"></a>00076 <span class="preprocessor">#if (NF_GENERIC_DRIVER==(TRUE))</span>
<a name="l00077"></a><a class="code" href="a00063.html#274b9bbe013bba444abdaed38d651735">00077</a> <span class="preprocessor"></span><span class="preprocessor">#  define NF_PAGE_BUFFER_SIZE         2048</span>
<a name="l00078"></a>00078 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l00079"></a>00079 <span class="preprocessor"></span><span class="comment">//#  define NF_PAGE_BUFFER_SIZE         (1L&lt;&lt;NF_SHIFT_PAGE_BYTE)</span>
<a name="l00080"></a>00080 <span class="preprocessor">#  define NF_PAGE_BUFFER_SIZE         2048</span>
<a name="l00081"></a>00081 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00082"></a><a class="code" href="a00063.html#f80c4ce07be5eb80f1fa7e96dd19aa8a">00082</a> <span class="preprocessor"></span><span class="preprocessor">#define NF_FULL_PAGE_BUFFER_SIZE    ( (NF_PAGE_BUFFER_SIZE) + (NF_PAGE_BUFFER_SIZE)/32 )</span>
<a name="l00083"></a><a class="code" href="a00063.html#fec3c6701415feaba7c4549f19f43946">00083</a> <span class="preprocessor"></span><span class="preprocessor">#define NF_SHIFT_SUBLUT_PHYS      ( (G_SHIFT_PAGE_BYTE)-1 )        // (1&lt;&lt;n) size of sublut, unit in physical block</span>
<a name="l00084"></a><a class="code" href="a00063.html#bd398c181df0934d401cafd7447ddd10">00084</a> <span class="preprocessor"></span><span class="preprocessor">#define NF_SUBLUT_SIZE            ( 1L&lt;&lt;(NF_SHIFT_SUBLUT_PHYS) )   // size of sublut, unit in physical block</span>
<a name="l00085"></a>00085 <span class="preprocessor"></span>
<a name="l00086"></a>00086 
<a name="l00087"></a>00087 <span class="preprocessor">#if (NF_AUTO_DETECT_2KB==TRUE)</span>
<a name="l00088"></a><a class="code" href="a00063.html#5f257c64502cfaa99ca2a1c1b20ef777">00088</a> <span class="preprocessor"></span><span class="preprocessor">#  define NF_N_MAX_BLOCKS    (8*1024)  // Allow 1GByte for 2kB-NF</span>
<a name="l00089"></a><a class="code" href="a00063.html#28826e9d277e2bdd262d82d6caf78f29">00089</a> <span class="preprocessor"></span><span class="preprocessor">#  define N_SUBLUT    (NF_N_DEVICES*NF_N_MAX_BLOCKS/(512/2))</span>
<a name="l00090"></a>00090 <span class="preprocessor"></span>
<a name="l00091"></a>00091 <span class="preprocessor">#elif (NF_AUTO_DETECT_512B==TRUE)</span>
<a name="l00092"></a>00092 <span class="preprocessor"></span><span class="preprocessor">#  define NF_N_MAX_BLOCKS    (8*1024)  // Allow 128MB for 512B-NF</span>
<a name="l00093"></a>00093 <span class="preprocessor"></span><span class="preprocessor">#  define N_SUBLUT    (NF_N_DEVICES*NF_N_MAX_BLOCKS/(512/2))</span>
<a name="l00094"></a>00094 <span class="preprocessor"></span>
<a name="l00095"></a>00095 <span class="preprocessor">#else</span>
<a name="l00096"></a>00096 <span class="preprocessor"></span><span class="preprocessor">#  if (NF_GENERIC_DRIVER==(TRUE))</span>
<a name="l00097"></a>00097 <span class="preprocessor"></span><span class="preprocessor">#     define N_SUBLUT    (NF_N_DEVICES*NF_N_BLOCKS/(512/2))     To check...</span>
<a name="l00098"></a>00098 <span class="preprocessor"></span><span class="preprocessor">#  else</span>
<a name="l00099"></a>00099 <span class="preprocessor"></span><span class="preprocessor">#     define N_SUBLUT    (NF_N_DEVICES*NF_N_BLOCKS/(1L&lt;&lt;(NF_SHIFT_PAGE_BYTE-1)))</span>
<a name="l00100"></a>00100 <span class="preprocessor"></span><span class="preprocessor">#  endif</span>
<a name="l00101"></a>00101 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00102"></a>00102 <span class="preprocessor"></span>
<a name="l00103"></a>00103 <span class="preprocessor">#if (NF_GENERIC_DRIVER==TRUE)</span>
<a name="l00104"></a><a class="code" href="a00063.html#b7b418925e68e7dc40aa9a74613cb6ee">00104</a> <span class="preprocessor"></span><span class="preprocessor">#  define S_SHIFT_SECTOR_BYTE       s_shift_sector_byte</span>
<a name="l00105"></a><a class="code" href="a00063.html#b66eee9a9e0d27e395572c4977e2718a">00105</a> <span class="preprocessor"></span><span class="preprocessor">#  define S_SHIFT_LOG_PAGE_SECTOR   s_shift_log_page_sector</span>
<a name="l00106"></a><a class="code" href="a00063.html#fdb4a2af55e4352eff66adadabebac1d">00106</a> <span class="preprocessor"></span><span class="preprocessor">#  define S_SHIFT_LOG_BLOCK_SECTOR  s_shift_log_block_sector</span>
<a name="l00107"></a>00107 <span class="preprocessor"></span><span class="preprocessor">#  error  To be tested</span>
<a name="l00108"></a>00108 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l00109"></a>00109 <span class="preprocessor"></span><span class="preprocessor">#  define S_SHIFT_SECTOR_BYTE       (NF_SHIFT_SECTOR_BYTE)</span>
<a name="l00110"></a>00110 <span class="preprocessor"></span><span class="preprocessor">#  define S_SHIFT_LOG_PAGE_SECTOR   ((G_SHIFT_PAGE_BYTE - S_SHIFT_SECTOR_BYTE) + NF_SHIFT_N_DEVICES)</span>
<a name="l00111"></a>00111 <span class="preprocessor"></span><span class="preprocessor">#  define S_SHIFT_LOG_BLOCK_SECTOR  ((S_SHIFT_LOG_PAGE_SECTOR) + (G_SHIFT_BLOCK_PAGE))</span>
<a name="l00112"></a>00112 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00113"></a>00113 <span class="preprocessor"></span>
<a name="l00114"></a>00114 
<a name="l00115"></a><a class="code" href="a00063.html#85f227c39b86316cd59782313371c343">00115</a> <span class="preprocessor">#define S_MNGT_DEV                ((NF_N_DEVICES)-1)</span>
<a name="l00116"></a>00116 <span class="preprocessor"></span>
<a name="l00117"></a>00117 <span class="preprocessor">#if (_ASSERT_==ENABLE)</span>
<a name="l00118"></a><a class="code" href="a00063.html#6b50ad24827c3400322c54374b047221">00118</a> <span class="preprocessor"></span><a class="code" href="a00032.html#35d552e8456cfb2b810baa0a9212c98e">_MEM_TYPE_SLOW_</a> <a class="code" href="a00032.html#df928e51a60dba0df29d615401cc55a8">U16</a> <a class="code" href="a00063.html#6b50ad24827c3400322c54374b047221">_debug</a>;
<a name="l00119"></a>00119 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="a00062.html#c9c878ced2e50015d7bfdadba72bf2ed">nf_check_fbb</a>( <a class="code" href="a00032.html#253b248072cfc8bd812c69acd0046eed">Bool</a> b_ecc_err );
<a name="l00120"></a>00120 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="a00062.html#0aac9e104db7a0ae59bf807994c344cc">nf_check_lut</a>( <span class="keywordtype">void</span> );
<a name="l00121"></a><a class="code" href="a00063.html#3a7e8fdae8fd67e400d1e05c4c40610f">00121</a> <span class="preprocessor">#  define Nf_check_fbb(x)  nf_check_fbb(x)</span>
<a name="l00122"></a><a class="code" href="a00063.html#d57b5bafad3a69fe6f786312acd3d0f1">00122</a> <span class="preprocessor"></span><span class="preprocessor">#  define Nf_check_lut()   nf_check_lut()</span>
<a name="l00123"></a>00123 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l00124"></a>00124 <span class="preprocessor"></span><span class="preprocessor">#  define Nf_check_fbb(x)</span>
<a name="l00125"></a>00125 <span class="preprocessor"></span><span class="preprocessor">#  define Nf_check_lut()</span>
<a name="l00126"></a>00126 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00127"></a>00127 <span class="preprocessor"></span>
<a name="l00128"></a><a class="code" href="a00002.html">00128</a> <span class="keyword">typedef</span> <span class="keyword">struct</span>
<a name="l00129"></a>00129 {
<a name="l00130"></a>00130    <span class="keyword">struct</span>
<a name="l00131"></a>00131    {
<a name="l00132"></a><a class="code" href="a00002.html#682f042876e5c6151971f573e9edace2">00132</a>       <a class="code" href="a00032.html#3cb25ca6f51f003950f9625ff05536fc">U8</a> valid:1 ;
<a name="l00133"></a><a class="code" href="a00002.html#437f7770ddf9f42e886ac70d2d4febdd">00133</a>       <a class="code" href="a00032.html#3cb25ca6f51f003950f9625ff05536fc">U8</a> dirty:1 ;
<a name="l00134"></a>00134    } ctrl;
<a name="l00135"></a><a class="code" href="a00002.html#1e9589be557c2cee79533909f867accc">00135</a>    <a class="code" href="a00032.html#df928e51a60dba0df29d615401cc55a8">U16</a>  first ; <span class="comment">// first logical number (included)</span>
<a name="l00136"></a><a class="code" href="a00002.html#881310cf48d26c52d2cc4f33ec4c19f6">00136</a>    <a class="code" href="a00032.html#df928e51a60dba0df29d615401cc55a8">U16</a>  last  ; <span class="comment">// last  logical number (included)</span>
<a name="l00137"></a><a class="code" href="a00063.html#2df50aa01ce5b4700edbd9d48534d662">00137</a> <span class="preprocessor">#define CACHE_LUT_SIZE   (NF_CACHE_LUT_LOG_SZ*NF_N_DEVICES) // Size in U16</span>
<a name="l00138"></a><a class="code" href="a00002.html#3cd2f9a20eddc59b8f7dead8ea956643">00138</a> <span class="preprocessor"></span>   <a class="code" href="a00032.html#df928e51a60dba0df29d615401cc55a8">U16</a>  mem[ <a class="code" href="a00063.html#2df50aa01ce5b4700edbd9d48534d662">CACHE_LUT_SIZE</a> ];
<a name="l00139"></a>00139 } <a class="code" href="a00002.html">Cache_lut</a>;
<a name="l00140"></a>00140 
<a name="l00141"></a><a class="code" href="a00001.html">00141</a> <span class="keyword">typedef</span> <span class="keyword">struct</span>
<a name="l00142"></a>00142 {
<a name="l00143"></a>00143    <span class="keyword">struct</span>
<a name="l00144"></a>00144    {
<a name="l00145"></a><a class="code" href="a00001.html#8a52216548fb199e1956d27fcf999427">00145</a>       <a class="code" href="a00032.html#3cb25ca6f51f003950f9625ff05536fc">U8</a> valid:1 ;
<a name="l00146"></a><a class="code" href="a00001.html#8435e2b050da6630b6f0798591d1501f">00146</a>       <a class="code" href="a00032.html#3cb25ca6f51f003950f9625ff05536fc">U8</a> dirty:1 ;
<a name="l00147"></a>00147    } ctrl;
<a name="l00148"></a><a class="code" href="a00001.html#bbfbdec71ac19ebd0a651bc24f4fd3a4">00148</a>    <a class="code" href="a00032.html#3cb25ca6f51f003950f9625ff05536fc">U8</a>   p     ; <span class="comment">// Current logical number position</span>
<a name="l00149"></a><a class="code" href="a00001.html#b185b551daa6cbea86c6b06fec920762">00149</a>    <a class="code" href="a00032.html#3cb25ca6f51f003950f9625ff05536fc">U8</a>   max   ; <span class="comment">// number of logical entry</span>
<a name="l00150"></a><a class="code" href="a00063.html#4385406f8199c1f4bc1db06d58e4bf6e">00150</a> <span class="preprocessor">#define CACHE_FBB_SIZE   (NF_CACHE_FBB_LOG_SZ*NF_N_DEVICES) // Size in U16</span>
<a name="l00151"></a><a class="code" href="a00001.html#3f573f15bc7d4791fef7662cb87256b7">00151</a> <span class="preprocessor"></span>   <a class="code" href="a00032.html#df928e51a60dba0df29d615401cc55a8">U16</a>  mem[ <a class="code" href="a00063.html#4385406f8199c1f4bc1db06d58e4bf6e">CACHE_FBB_SIZE</a> ];
<a name="l00152"></a>00152 } <a class="code" href="a00001.html">Cache_fbb</a>;
<a name="l00153"></a>00153 
<a name="l00154"></a><a class="code" href="a00063.html#ba98ad90dee97fdb6a9b9f2007ddde7e">00154</a> <span class="keyword">typedef</span> <span class="keyword">enum</span>
<a name="l00155"></a>00155 {
<a name="l00156"></a><a class="code" href="a00063.html#ba98ad90dee97fdb6a9b9f2007ddde7e281d51825490a7f8e95b88a77f03de71">00156</a>    <a class="code" href="a00063.html#ba98ad90dee97fdb6a9b9f2007ddde7e281d51825490a7f8e95b88a77f03de71">NF_READ</a>=0
<a name="l00157"></a><a class="code" href="a00063.html#ba98ad90dee97fdb6a9b9f2007ddde7eedcb0e56907fd3195f3cad2e2d1607aa">00157</a> ,  <a class="code" href="a00063.html#ba98ad90dee97fdb6a9b9f2007ddde7eedcb0e56907fd3195f3cad2e2d1607aa">NF_WRITE</a>
<a name="l00158"></a>00158 } <a class="code" href="a00063.html#ba98ad90dee97fdb6a9b9f2007ddde7e">Nf_sense</a>;
<a name="l00159"></a>00159 
<a name="l00160"></a>00160 <span class="comment">//_____ F U N C T I O N S __________________________________________________</span>
<a name="l00161"></a>00161 
<a name="l00162"></a>00162 <a class="code" href="a00042.html#910a0fdf1e7a70b08981dce14e86e291" title="Define control status.">Ctrl_status</a>    <a class="code" href="a00062.html#842d42e30e0ae29382313535b396163c" title="Initializes the NF driver on the first USB Test Unit Ready.">nf_test_unit_ready</a>         ( <span class="keywordtype">void</span> ) ;
<a name="l00163"></a>00163 <a class="code" href="a00042.html#910a0fdf1e7a70b08981dce14e86e291" title="Define control status.">Ctrl_status</a>    <a class="code" href="a00062.html#5f95a4eb670bcd8a77961f65e8fcb330" title="Returns the address of the last valid logical sector.">nf_read_capacity</a>           ( <a class="code" href="a00032.html#811024d35b9b8a41095b1f583b649e56">U32</a>* ) ;
<a name="l00164"></a>00164 <a class="code" href="a00032.html#253b248072cfc8bd812c69acd0046eed">Bool</a>           <a class="code" href="a00062.html#025a42a5797bf8f4ae78f5e0cddc0842">nf_wr_protect</a>              ( <span class="keywordtype">void</span> ) ;
<a name="l00165"></a>00165 <a class="code" href="a00032.html#253b248072cfc8bd812c69acd0046eed">Bool</a>           <a class="code" href="a00062.html#0034234ddcc3a96d3427630292f3b8db">nf_removal</a>                 ( <span class="keywordtype">void</span> ) ;
<a name="l00166"></a>00166 <a class="code" href="a00042.html#910a0fdf1e7a70b08981dce14e86e291" title="Define control status.">Ctrl_status</a>    <a class="code" href="a00063.html#3b284e8f087a2c3001198b97bd721e53">nf_10</a>                      ( <a class="code" href="a00032.html#811024d35b9b8a41095b1f583b649e56">U32</a> addr , <a class="code" href="a00032.html#df928e51a60dba0df29d615401cc55a8">U16</a> nb_sector, <a class="code" href="a00063.html#ba98ad90dee97fdb6a9b9f2007ddde7e">Nf_sense</a> );
<a name="l00167"></a>00167 
<a name="l00168"></a>00168 <a class="code" href="a00042.html#910a0fdf1e7a70b08981dce14e86e291" title="Define control status.">Ctrl_status</a>    <a class="code" href="a00063.html#7990ecd39062bd090edc8a64938b0e2f">nf_dfc_read_resume</a>         ( <span class="keywordtype">void</span> );   <span class="comment">// function that resume the dfc interface of the memory</span>
<a name="l00169"></a>00169 <a class="code" href="a00042.html#910a0fdf1e7a70b08981dce14e86e291" title="Define control status.">Ctrl_status</a>    <a class="code" href="a00063.html#beeec1cfcc2701c2ab11e119fa3b1a41">nf_dfc_write_resume</a>        ( <span class="keywordtype">void</span> );   <span class="comment">// function that resume the dfc interface of the memory</span>
<a name="l00170"></a>00170 <a class="code" href="a00042.html#910a0fdf1e7a70b08981dce14e86e291" title="Define control status.">Ctrl_status</a>    <a class="code" href="a00063.html#09b6c47dfda1881476ee6e32a402c9eb">nf_dfc_read_stop</a>           ( <a class="code" href="a00032.html#df928e51a60dba0df29d615401cc55a8">U16</a> remaining_sectors );   <span class="comment">// function that stops the dfc interface of the memory</span>
<a name="l00171"></a>00171 <a class="code" href="a00042.html#910a0fdf1e7a70b08981dce14e86e291" title="Define control status.">Ctrl_status</a>    <a class="code" href="a00062.html#d45465832eded4b9de5dfa9b095482bd" title="This function must be called when a write10 operation (from USB) is finished Last...">nf_dfc_write_stop</a>          ( <a class="code" href="a00032.html#df928e51a60dba0df29d615401cc55a8">U16</a> remaining_sectors );   <span class="comment">// function that stops the dfc interface of the memory</span>
<a name="l00172"></a>00172 
<a name="l00173"></a>00173 <span class="keywordtype">void</span>           <a class="code" href="a00063.html#5c506bec40bbca03b0cffa8ef7cd7e11">nf_dfc_read_standby</a>        ( <a class="code" href="a00032.html#df928e51a60dba0df29d615401cc55a8">U16</a> );
<a name="l00174"></a>00174 <span class="keywordtype">void</span>           <a class="code" href="a00063.html#dd49676601c79bc6c52b85e5e8a60561">nf_dfc_read_restart</a>        ( <span class="keywordtype">void</span> );
<a name="l00175"></a>00175 
<a name="l00176"></a>00176 <a class="code" href="a00032.html#811024d35b9b8a41095b1f583b649e56">U32</a>            <a class="code" href="a00062.html#f935b5cf31febdb455f0b157944ae27b" title="Returns a pointer on the internal buffer address.">nf_get_sectors_number</a>      ( <span class="keywordtype">void</span> ) ;
<a name="l00177"></a>00177 <a class="code" href="a00032.html#3cb25ca6f51f003950f9625ff05536fc">U8</a>*            <a class="code" href="a00063.html#15475d6193583f87740f8dfa6219772b">nf_get_buffer_addr</a>         ( <span class="keywordtype">void</span> ) ;
<a name="l00178"></a>00178 <span class="keywordtype">void</span>           <a class="code" href="a00063.html#7fa3ba35a1436fa32cc3a53d079dedc0" title="Initializes the nand flash memory driver.">nf_init</a>                    ( <span class="keywordtype">void</span> ) ;
<a name="l00179"></a>00179 <a class="code" href="a00032.html#a95502d3ad090c7564841b21b6aedcee">Status_bool</a>    <a class="code" href="a00062.html#5bc1ea382d755aa7efeffbd008c3347a" title="Ensure that the memory is in a good state before starting to use it.">nf_verify</a>                  ( <span class="keywordtype">void</span> ) ;
<a name="l00180"></a>00180 <a class="code" href="a00032.html#a95502d3ad090c7564841b21b6aedcee">Status_bool</a>    <a class="code" href="a00063.html#b3c26aadc0e38a2d67aac9080152777a" title="Ensure that the memory is in a good state before starting to use it.">nf_verify_resume</a>           ( <span class="keywordtype">void</span> ) ;
<a name="l00181"></a>00181 <span class="keywordtype">void</span>           <a class="code" href="a00063.html#4111df3ea1a2e262cdc7b853bad4543f" title="Cleanup the memory by erasing all the management blocks.">nf_cleanup_memory</a>          ( <span class="keywordtype">void</span> ) ;
<a name="l00182"></a>00182 <span class="keywordtype">void</span>           <a class="code" href="a00062.html#d530651d772a5d7f5c1ff3bf91eda4c2" title="Upload packets of 16 bytes from the NAND Flash to RAM.">nf_upload</a>                  ( <a class="code" href="a00032.html#3cb25ca6f51f003950f9625ff05536fc">U8</a> <a class="code" href="a00032.html#35d552e8456cfb2b810baa0a9212c98e">_MEM_TYPE_SLOW_</a>*, <a class="code" href="a00032.html#3cb25ca6f51f003950f9625ff05536fc">U8</a> );
<a name="l00183"></a>00183 <span class="keywordtype">void</span>           <a class="code" href="a00062.html#b7f3d7c1f70d339f8613aaaeb4262959" title="Download packets of 16 bytes from RAM to the NAND Flash.">nf_download</a>                ( <a class="code" href="a00032.html#3cb25ca6f51f003950f9625ff05536fc">U8</a> <a class="code" href="a00032.html#35d552e8456cfb2b810baa0a9212c98e">_MEM_TYPE_SLOW_</a>*, <a class="code" href="a00032.html#3cb25ca6f51f003950f9625ff05536fc">U8</a> );
<a name="l00184"></a>00184 <a class="code" href="a00032.html#811024d35b9b8a41095b1f583b649e56">U32</a>            <a class="code" href="a00062.html#f713bee0ed464d2bfa6876cd9d4ef296">nf_block_2_page</a>            ( <a class="code" href="a00032.html#df928e51a60dba0df29d615401cc55a8">U16</a> block_addr );
<a name="l00185"></a>00185 <span class="keywordtype">void</span>           <a class="code" href="a00063.html#ae85309c46a253ef08a961b99657ede0">nf_ecc_mngt</a>                ( <span class="keywordtype">void</span> );
<a name="l00186"></a>00186 <span class="keywordtype">void</span>           <a class="code" href="a00063.html#f41b35e9c4b10553fb3877f8c394188c">nf_sync</a>                    ( <span class="keywordtype">void</span> );
<a name="l00187"></a>00187 <span class="keywordtype">void</span>           <a class="code" href="a00062.html#79e27718d9bc988607f630c2ff410848" title="Copy a NF page to a new one.">nf_copy</a>                    ( <a class="code" href="a00032.html#811024d35b9b8a41095b1f583b649e56">U32</a> copy_dst );
<a name="l00188"></a>00188 <a class="code" href="a00032.html#a95502d3ad090c7564841b21b6aedcee">Status_bool</a>    <a class="code" href="a00062.html#4033ef04a3cbd39dc9d6071c6d7c2a9b" title="Writes a LUT in memory from a buffer.">nf_write_lut</a>               ( <a class="code" href="a00032.html#3cb25ca6f51f003950f9625ff05536fc">U8</a> pos, <a class="code" href="a00032.html#3cb25ca6f51f003950f9625ff05536fc">U8</a> i_sub_lut, <a class="code" href="a00032.html#df928e51a60dba0df29d615401cc55a8">U16</a> sub_lut_log_sz );
<a name="l00189"></a>00189 <a class="code" href="a00032.html#a95502d3ad090c7564841b21b6aedcee">Status_bool</a>    <a class="code" href="a00062.html#020f4fb7d7d55f3fad9c368ac04cabf3" title="Writes the Free-blocks block into the Nand Flash.">nf_write_fbb</a>               ( <span class="keywordtype">void</span> );
<a name="l00190"></a>00190 <span class="keywordtype">void</span>           <a class="code" href="a00062.html#524dde7169bece3f9ce79e1c56d7412b" title="Reload the FBB cache memory, starting from 0.">nf_cache_fbb_refill</a>        ( <span class="keywordtype">void</span> );
<a name="l00191"></a>00191 <span class="keywordtype">void</span>           <a class="code" href="a00062.html#1a579e74d337851734361358c99c603e" title="Swap 2 blocks from the LUT and the FBB.">nf_swap</a>                    (<a class="code" href="a00032.html#3cb25ca6f51f003950f9625ff05536fc">U8</a> dev_id, <a class="code" href="a00032.html#3cb25ca6f51f003950f9625ff05536fc">U8</a> u8_ofst_lut, <a class="code" href="a00032.html#3cb25ca6f51f003950f9625ff05536fc">U8</a> u8_ofst_fbb);
<a name="l00192"></a>00192 <span class="keywordtype">void</span>           <a class="code" href="a00062.html#4eb467f47ee05e8b863e8da657db4c2f" title="Flushes the FBB cache into a new FBB entry.">nf_cache_fbb_flush</a>         ( <a class="code" href="a00032.html#253b248072cfc8bd812c69acd0046eed">Bool</a> );
<a name="l00193"></a>00193 <span class="keywordtype">void</span>           <a class="code" href="a00063.html#8a8cd7007fd3561ea61f83641f7d3278">nf_recovery</a>(            <a class="code" href="a00032.html#df928e51a60dba0df29d615401cc55a8">U16</a> block_1, <a class="code" href="a00032.html#df928e51a60dba0df29d615401cc55a8">U16</a> block_2);
<a name="l00194"></a>00194 <span class="keywordtype">void</span>           <a class="code" href="a00062.html#a38cbc2641b27ca8fe33b40dbfdd7486">nf_copy_tail</a>               ( <span class="keywordtype">void</span> );
<a name="l00195"></a>00195 
<a name="l00196"></a>00196 <span class="comment">// New functions, to be tested</span>
<a name="l00197"></a>00197 <a class="code" href="a00042.html#910a0fdf1e7a70b08981dce14e86e291" title="Define control status.">Ctrl_status</a>    <a class="code" href="a00062.html#1c583c1d616f3af3e57ebe914cf747e9" title="This function initializes the Nand Flash for a read operation.">nf_read_10</a>( <a class="code" href="a00032.html#811024d35b9b8a41095b1f583b649e56">U32</a> log_sector , <a class="code" href="a00032.html#df928e51a60dba0df29d615401cc55a8">U16</a> n_sectors);
<a name="l00198"></a>00198 <a class="code" href="a00042.html#910a0fdf1e7a70b08981dce14e86e291" title="Define control status.">Ctrl_status</a>    <a class="code" href="a00062.html#fd80e982702f51b6ad94632856b980e1" title="This function initializes the Nand Flash for a write operation.">nf_write_10</a>( <a class="code" href="a00032.html#811024d35b9b8a41095b1f583b649e56">U32</a> log_sector , <a class="code" href="a00032.html#df928e51a60dba0df29d615401cc55a8">U16</a> n_sectors);
<a name="l00199"></a>00199 <a class="code" href="a00042.html#910a0fdf1e7a70b08981dce14e86e291" title="Define control status.">Ctrl_status</a>    <a class="code" href="a00062.html#c0569fdce920e24874d30f1b25dfe3c8" title="This fonction initialise the memory for a write operation from ram buffer.">nf_ram_2_nf</a>                (<a class="code" href="a00032.html#811024d35b9b8a41095b1f583b649e56">U32</a> addr, <a class="code" href="a00032.html#3cb25ca6f51f003950f9625ff05536fc">U8</a> *ram);
<a name="l00200"></a>00200 <a class="code" href="a00042.html#910a0fdf1e7a70b08981dce14e86e291" title="Define control status.">Ctrl_status</a>    <a class="code" href="a00062.html#18cf312e26c74a2f8ff049bf172a56d4" title="This fonction read 1 sector from NF to ram buffer.">nf_nf_2_ram</a>                (<a class="code" href="a00032.html#811024d35b9b8a41095b1f583b649e56">U32</a> addr, <a class="code" href="a00032.html#3cb25ca6f51f003950f9625ff05536fc">U8</a> *ram);
<a name="l00201"></a>00201 
<a name="l00202"></a>00202 <span class="preprocessor">#endif  // _NF_MNGT_H_</span>
<a name="l00203"></a>00203 <span class="preprocessor"></span>
</pre></div><hr size="1"><address style="text-align: right;"><small>Generated on Mon Sep 14 13:14:18 2009 for ATMEL by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.3 </small></address>
</body>
</html>
